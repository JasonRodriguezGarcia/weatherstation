VersiÃ³n modificada: ESP8266 recibe los datos desde Arduino por Serial
âœ” Cambios principales realizados:

Se elimina todo lo referente al sensor DHT.

Se elimina la librerÃ­a DHT.

El ESP8266 ahora lee temperatura y humedad del puerto serial (Serial).

Se incluye un pequeÃ±o parser para separar temp/hum.

El resto del cÃ³digo (LCD, envÃ­o HTTPS, etc.) queda intacto.

ğŸ”§ CÃ“DIGO MODIFICADO

Solo copia y pega, ya estÃ¡ listo para usar.

// ------------------------------
//    WEATHER STATION (ESP8266)
//   Recibe datos desde Arduino
// ------------------------------

// Esto para ESP8266
#include <ESP8266WiFi.h>
#include <ESP8266HTTPClient.h>

// HTTPS
#include <WiFiClientSecure.h>

// LCD I2C
#include <Wire.h>
#include <LiquidCrystal_I2C.h>

LiquidCrystal_I2C lcd(0x3F, 16, 2);

// URL de API
const char* apiBaseUrl = "https://weatherstation-hyck.onrender.com/api/v1/";
const char* apiKey = "tu_clave_de_api";

String deviceId;

// ------------------
// CONFIGURACIÃ“N
// ------------------
void setup() {
    Serial.begin(9600);     // PARA RECIBIR DATOS DESDE ARDUINO
    Serial.setTimeout(2000);

    // LCD
    lcd.init();
    lcd.backlight();
    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.print("Weather Station");
    lcd.setCursor(0, 1);
    lcd.print("Booting...");

    // WIFI
    WiFi.begin("xxxxxxxx", "xxxxxxxx");

    while (WiFi.status() != WL_CONNECTED) {
        delay(500);
        Serial.println("Conectando WIFI...");
    }

    Serial.println("WiFi conectado!");

    deviceId = WiFi.macAddress();
    deviceId.replace(":", "");

    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.print("MAC: ");
    lcd.print(deviceId);

    delay(2000);
}

void loop() {

  // --------------------------
  // LEER DATOS DEL ARDUINO
  // --------------------------
  if (Serial.available()) {
      String data = Serial.readStringUntil('\n');
      data.trim();

      Serial.print("Recibido: ");
      Serial.println(data);

      // ESPERA FORMATO: TEMP,HUM
      float temperature_data = NAN;
      float humidity_data = NAN;

      int coma = data.indexOf(',');

      if (coma > 0) {
          temperature_data = data.substring(0, coma).toFloat();
          humidity_data = data.substring(coma + 1).toFloat();
      }

      if (isnan(temperature_data) || isnan(humidity_data)) {
          Serial.println("ERROR: Datos recibidos invÃ¡lidos");
          lcd.clear();
          lcd.setCursor(0,0);
          lcd.print("Datos invalidos");
          return;
      }

      // Mostrar en LCD
      lcd.clear();
      lcd.setCursor(0,0);
      lcd.print("Temp: ");
      lcd.print(temperature_data);
      lcd.print(" C");

      lcd.setCursor(0,1);
      lcd.print("Hum: ");
      lcd.print(humidity_data);
      lcd.print(" %");

      // Enviar a API
      sendDataToApi(temperature_data, humidity_data);
  }

  delay(200);
}



// -----------------------------------------
// ENVÃO DE DATOS A LA API
// -----------------------------------------
void sendDataToApi(float temperature_data, float humidity_data) {
  WiFiClientSecure client;
  client.setInsecure();       // <<< si quieres evitar fingerprint

  HTTPClient http;

  String url = String(apiBaseUrl) + "meassures";
  Serial.println("URL: " + url);

  http.begin(client, url);

  http.addHeader("Content-Type", "application/json");

  String jsonData = "{\"device_id\": \"" + deviceId +
                    "\", \"temperature\": " + String(temperature_data) +
                    ", \"humidity\": " + String(humidity_data) + "}";

  int httpCode = http.POST(jsonData);

  if (httpCode > 0) {
      if (httpCode >= 200 && httpCode < 300) {
          Serial.println("OK: " + http.getString());
      } else {
          Serial.println("Error HTTP: " + String(httpCode));
      }
  } else {
      Serial.println("Error conexion: " + String(http.errorToString(httpCode)));
  }

  http.end();
}

ğŸ“Œ Â¿QuÃ© debe enviar tu Arduino?

CÃ³digo ejemplo del ARDUINO UNO / NANO:

void setup() {
  Serial.begin(9600);
}

void loop() {
  float t = 25.4;
  float h = 60.2;

  Serial.print(t);
  Serial.print(",");
  Serial.println(h);

  delay(2000);
}

âœ” Con esto ya tienes:

Arduino â†’ envÃ­a temperatura y humedad por Serial

ESP8266 â†’ recibe los datos

Muestra en LCD

EnvÃ­a JSON a la API

No depende de DHT11/DHT22

Si quieres, puedo:

âœ… Adaptar el cÃ³digo a un Arduino Mega, Nano, Pro Mini, etc.
âœ… Hacer la comunicaciÃ³n por SoftwareSerial si tu Arduino tiene un solo puerto.
âœ… Enviar formato JSON en lugar de "temp,hum".

Â¿Quieres que te prepare tambiÃ©n el cÃ³digo del Arduino?

TÃº dijiste:
como conectar el ardunio al ESP8266
ChatGPT Plus

AquÃ­ tienes la forma correcta y segura de conectar un Arduino a un ESP8266 para enviar datos por Serial.
Te doy todas las opciones, incluida la forma segura (con divisor de voltaje) porque el ESP8266 NO soporta 5V en su pin RX.

âœ… 1) Identifica quÃ© ESP8266 tienes

Las dos variantes mÃ¡s comunes:

âœ” NodeMCU / Wemos D1 Mini (ESP8266 con USB)

Funciona a 3.3V pero sus pines son tolerantes a 5V por el regulador/convertidor USB.

Puedes conectar directamente el TX del Arduino a RX del ESP8266 si usas SoftwareSerial a 9600 bps.

âœ” ESP-01 o mÃ³dulo ESP8266 â€œpuroâ€

NO tolera 5V

Necesitas un adaptador de nivel (divisor de voltaje) en RX.

Dime cuÃ¡l tienes y te ajusto el esquema exacto, pero te pongo ambos.

ğŸ”Œ 2) ConexiÃ³n para NodeMCU / Wemos D1 Mini

(la mÃ¡s tÃ­pica y fÃ¡cil)

â­ SOLO ESTOS 4 CABLES:
Arduino TX  â†’  ESP8266 RX (GPIO3)
Arduino GND â†’  ESP8266 GND


âš  IMPORTANTE:

NO uses el pin TX/RX hardware del ESP8266 porque es el mismo que usa para programaciÃ³n.

Es mejor usar SoftwareSerial en el ESP8266 en pines como D5â€“D6.

ğŸ”§ ConexiÃ³n recomendada:
Arduino	ESP8266
TX â†’	D5 (GPIO14)
GND â†’	GND

Luego en el ESP8266 usas:

#include <SoftwareSerial.h>
SoftwareSerial arduinoSerial(D5, D6); // RX, TX


(Solo usarÃ¡s D5 como RX, y D6 no se conecta si solo recibes datos.)

ğŸ”Œ 3) ConexiÃ³n para ESP8266-01 o mÃ³dulo â€œpuroâ€

Necesitas bajar el voltaje del TX del Arduino (5V) a RX del ESP8266 (3.3V):

â­ Divisor de voltaje:
Arduino TX ---- 1kÎ© ----+---- ESP8266 RX
                        |
                       2kÎ©
                        |
                       GND


O un mÃ³dulo adaptador de nivel lÃ³gico.

âš¡ AlimentaciÃ³n
âœ” Si usas NodeMCU / Wemos:

Se alimenta por USB directamente.

Arduino puede alimentarse aparte sin problema.

Solo necesitas compartir GND.

âœ” Si usas ESP8266-01:

Necesita 3.3V estable con mÃ­nimo 300 mA (ojo).

NO alimentarlo desde el pin 3.3V del Arduino.

ğŸŸ¦ Resumen segÃºn tu objetivo

Quieres que:

Arduino â†’ envÃ­a temperatura y humedad â†’ ESP8266 la recibe y la envÃ­a por WiFi

ConexiÃ³n mÃ­nima:

Arduino GND â†’ ESP8266 GND
Arduino TX  â†’ ESP8266 RX (con divisor si es mÃ³dulo puro)

ğŸ“Œ Â¿QuÃ© Arduino tienes? Â¿Y quÃ© ESP8266 exactamente?

Dime modelo exacto (Arduino UNO/Nano/Mega + NodeMCU/Wemos/ESP-01) y te hago:

El diagrama exacto

El cÃ³digo listo para copiar/pegar para ambos

La velocidad serial recomendada

CÃ³mo verificar que la comunicaciÃ³n funciona

Si me dices tu hardware, te lo dejo 100% afinado.

TÃº dijiste:
NodeMCU
ChatGPT Plus

Perfecto, con un NodeMCU (ESP8266) la conexiÃ³n con el Arduino es muy sencilla y segura, porque puedes usar SoftwareSerial y NO necesitas adaptadores de voltaje.

AquÃ­ tienes el esquema exacto, el cableado, y el cÃ³digo listo para usar.

ğŸ”Œ ğŸ”§ CONEXIÃ“N ARDUINO â†’ NODEMCU (ESP8266)
â­ SOLO 2 CABLES:
Arduino	NodeMCU
TX	D5 (GPIO14)
GND	GND

â›” NO conectes el RX del Arduino (no lo necesitas si solo el Arduino envÃ­a datos).
â›” NO uses el pin RX del ESP8266 (GPIO3) porque es el mismo que usa para programarse.

ğŸ“¡ Â¿Por quÃ© D5 como RX del ESP8266?

Porque el NodeMCU tiene los pines TX0 / RX0 reservados para USBâ€“serial.
Usar D5 evita interferencias.

ğŸ”§ CÃ“DIGO PARA EL ESP8266 (NodeMCU)

Este fragmento sustituye tu lectura del DHT y usa SoftwareSerial:

#include <SoftwareSerial.h>

// RX=D5, TX no usado
SoftwareSerial arduinoSerial(D5, D6); // D6 no hace falta conectar

void setup() {
  Serial.begin(9600);       // Debug por USB
  arduinoSerial.begin(9600); // Lectura desde Arduino
}

void loop() {
  if (arduinoSerial.available()) {
    String data = arduinoSerial.readStringUntil('\n');
    data.trim();
    Serial.println("Recibido del Arduino: " + data);
    
    // AquÃ­ haces tu parseo: "25.4,60.2"
    int coma = data.indexOf(',');
    if (coma > 0) {
      float temperature = data.substring(0, coma).toFloat();
      float humidity = data.substring(coma + 1).toFloat();
      
      Serial.println("Temperatura: " + String(temperature));
      Serial.println("Humedad: " + String(humidity));

      // AquÃ­ llamas a tu funciÃ³n sendDataToApi(...)
    }
  }
}

ğŸ”§ CÃ“DIGO DEL ARDUINO

Ejemplo: Arduino envÃ­a temperatura y humedad cada 2 segundos:

void setup() {
  Serial.begin(9600);
}

void loop() {
  float t = 24.5;
  float h = 60.1;

  Serial.print(t);
  Serial.print(",");
  Serial.println(h);

  delay(2000);
}

ğŸ“Œ ComprobaciÃ³n rÃ¡pida

Para verificar que funciona:

Conecta Arduino TX â†’ NodeMCU D5

Conecta GND â†” GND

Abre el Monitor Serial del NodeMCU (9600)

Debes ver algo como:

Recibido del Arduino: 24.5,60.1
Temperatura: 24.50
Humedad: 60.10

âœ” Ahora ya puedes integrar esta lectura en tu cÃ³digo final

Si quieres, puedo insertarlo dentro de tu cÃ³digo completo (el que envÃ­a a la API HTTPS) para que te quede todo junto y funcionando de inmediato.